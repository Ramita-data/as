<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DreamPop Therapy — Advanced</title>

  <meta name="theme-color" content="#8b7cff">
  <meta name="description" content="Relax, meditate, and enhance your mental wellness with DreamPop Therapy.">

  <!-- Icons -->
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
  <link rel="apple-touch-icon" href="icon-512.png">
  <link rel="manifest" href="manifest.json">

  <link rel="stylesheet" href="style.css">

  <!-- Phaser -->
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
</head>
<body>
  <div id="game-container">
    <div id="topbar">
      <div style="display:flex;gap:8px;align-items:center">
        <div style="font-weight:700;font-size:16px">DreamPop Therapy</div>
        <div style="opacity:0.8;font-size:13px">— calm, pop, transform</div>
      </div>
      <div id="hud">
        <button id="dailyBtn" class="btn small">Daily Calm (5m)</button>
        <div id="daily-timer">00:00</div>
        <button id="customBtn" class="btn small">Customize</button>
        <button id="saveBtn" class="btn small">Save</button>
      </div>
    </div>

    <div id="phaser-root" style="flex:1"></div>

    <div id="custom-panel" style="display:none">
      <label>Bubble Color</label>
      <input id="colorPicker" type="color" value="#8b7cff"/>
      <label style="margin-top:8px">Background Hue</label>
      <input id="bgPicker" type="color" value="#0b0920"/>
      <div style="margin-top:10px;display:flex;gap:6px">
        <button id="applyCustom" class="btn small">Apply</button>
        <button id="resetCustom" class="btn small">Reset</button>
      </div>
    </div>

    <div id="credits">DreamPop • Phaser.js • Firebase • PayPal Donations</div>
  </div>

  <!-- PayPal Donation -->
  <div id="paypal-button-container" style="margin:20px;text-align:center"></div>
  <script src="https://www.paypal.com/sdk/js?client-id=AephZnZjt38R4oo-IvCVM_3FdRV9T4dHV7iH51gD-xT6_2Jnn1n327fk4NMnMWT59VNxzh1kIqXjG58A"></script>
  <script>
    window.addEventListener('load', () => {
      if (window.paypal) {
        paypal.Buttons({
          createOrder: (data, actions) => actions.order.create({
            purchase_units: [{ amount: { value: '1.00' } }]
          }),
          onApprove: (data, actions) => actions.order.capture().then(() => alert('Thank you for your donation!'))
        }).render('#paypal-button-container');
      } else {
        console.error('PayPal SDK failed to load.');
      }
    });
  </script>

  <script src="app.js"></script>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
          .then(reg => console.log('Service Worker registered:', reg))
          .catch(err => console.error('SW registration failed:', err));
      });
    }
  </script>
</body>
</html>
